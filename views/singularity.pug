extends layout

block head
  link(rel='stylesheet', href='/stylesheets/singularity.css')

      --panel: #111426;
      --panel-border: #2b2e49;
      --text: #e6e6f0;
      --muted: #a5a8c2;
      --accent1: #ff6a00; /* neon orange */
      --accent2: #a000ff; /* neon purple */
      --accent3: #ff2ea6; /* magenta */
    }
    .wrap { background: radial-gradient(1200px 800px at 50% 40%, #14162a 0%, #0a0b10 60%, #06070b 100%); min-height: calc(100vh - 120px); border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.6); position: relative; overflow: hidden; }
    canvas#stage { width: 100%; height: 100%; display: block; }
    .hud { position: absolute; top: 16px; left: 16px; display: grid; gap: 10px; grid-template-columns: 1fr; max-width: min(420px, 90vw); z-index: 5; }
    .card { background: linear-gradient(180deg, rgba(17,20,38,0.95) 0%, rgba(10,11,16,0.92) 100%); border: 1px solid var(--panel-border); border-radius: 12px; padding: 12px; color: var(--text); backdrop-filter: blur(6px); }
    .title { font: 700 16px/1.2 ui-sans-serif, system-ui; letter-spacing: .02em; color: var(--text); margin: 0 0 6px 0; }
    .row { display: grid; grid-template-columns: 110px 1fr 56px; gap: 8px; align-items: center; margin: 6px 0; }
    .row label { color: var(--muted); font: 12px/1.2 ui-sans-serif, system-ui; }
    .row input[type=range] { width: 100%; accent-color: var(--accent2); }
    .row .val { font: 600 12px/1 ui-sans-serif; color: var(--accent2); text-align: right; }
    .bar { height: 8px; background: linear-gradient(90deg, var(--accent1), var(--accent3), var(--accent2)); border-radius: 999px; filter: blur(0.3px); opacity: .8; }
    .controls { display: grid; gap: 6px; }
    .row input[type=file] { color-scheme: dark; }
    .btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px; padding: 8px 12px; border-radius: 10px; background: #14172e; border: 1px solid var(--panel-border); color: var(--text); cursor: pointer; font: 600 12px ui-sans-serif; }
    .btn[data-on="true"] { outline: 2px solid color-mix(in oklab, var(--accent1) 60%, white 0%); background: #191d3a; color: #ffe; }
    .footer { position: absolute; right: 14px; bottom: 10px; color: var(--muted); font: 12px ui-sans-serif; z-index: 5; }

- var title = "DJ Stomp | Singularity"

block content
  header
    h1 Singularity
    p A GPU-accelerated, FFT-driven icosahedron with bloom. Drag to orbit, wheel to zoom. Gyro optional on mobile.

  .wrap
    .hud
      .card
        p.title Controls
        .bar
        .controls
          .row
            label(for="rot") Rotation
            input#rot(type="range" min="0" max="2.5" step="0.01" value="0.7")
            span.val#rotv 0.70
          .row
            label(for="dist") Distortion
            input#dist(type="range" min="0" max="3.0" step="0.01" value="1.2")
            span.val#distv 1.20
          .row
            label(for="react") Reactivity
            input#react(type="range" min="0" max="3.0" step="0.01" value="1.0")
            span.val#reactv 1.00
          .row
            label(for="res") Geometry
            input#res(type="range" min="0" max="3" step="1" value="2")
            span.val#resv 2
          .row
            label(for="bloom") Bloom
            input#bloom(type="range" min="0" max="2.5" step="0.01" value="1.3")
            span.val#bloomv 1.30
          .row
            label(for="file") Audio
            input#file(type="file" accept="audio/*")
            button.btn#play(type="button") ▶︎ Play
          .row
            label Gyro
            button.btn#gyro(type="button" data-on="false") Off
            span.val#stat Idle
      .card
        p.title Theme
        .bar
        .controls
          .row
            label Palette
            select#palette
              option(value="synth" selected) Synthwave
              option(value="noir") Noir Violet
              option(value="burn") Burning City
            span.val &nbsp;
    canvas#stage
    .footer ⏵ Now Playing: DJ Stomp - Singularity

  audio#player(preload="metadata" crossorigin="anonymous" src="/audio/singularity_320k.mp3")
  script(type="module" src="/javascripts/soundscape3.js")
